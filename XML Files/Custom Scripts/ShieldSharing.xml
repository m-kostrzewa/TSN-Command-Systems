<mission_data version="1.0" background_id_arme="77d373f9-ed2e-4726-a2b2-74bd775ac998" playerShipNames_arme="Artemis\Intrepid\Aegis\Horatio\Excalibur\Hera\Ceres\Diana">
  <start id_arme="77d373f9-ed2e-4726-a2b2-74bd775ac998">
    <!---->
  </start>

  
  

  <event name="Init Shield sharing" >
    <log text="Init Shield sharing" />

    <if_variable name="Sandbox Activation" comparator="EQUALS" value="3.0" />
    <if_variable name="Shield sharing initted" comparator="NOT" value="1.0" />

    
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="player0OriginalShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="player0OriginalShieldMaxStateBack" />
    <log text="player0OriginalShieldMaxStateFront=|player0OriginalShieldMaxStateFront| player0OriginalShieldMaxStateBack=|player0OriginalShieldMaxStateBack|" />
    
    <set_variable name="player0ShieldSharingEnabled" value="0.0" />

    <set_timer name="player0ShieldSharingDockCooldownTimer" seconds="1" />

    
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="player1OriginalShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="player1OriginalShieldMaxStateBack" />
    <log text="player1OriginalShieldMaxStateFront=|player1OriginalShieldMaxStateFront| player1OriginalShieldMaxStateBack=|player1OriginalShieldMaxStateBack|" />
    
    <set_variable name="player1ShieldSharingEnabled" value="0.0" />

    <set_timer name="player1ShieldSharingDockCooldownTimer" seconds="1" />

    
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="player2OriginalShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="player2OriginalShieldMaxStateBack" />
    <log text="player2OriginalShieldMaxStateFront=|player2OriginalShieldMaxStateFront| player2OriginalShieldMaxStateBack=|player2OriginalShieldMaxStateBack|" />
    
    <set_variable name="player2ShieldSharingEnabled" value="0.0" />

    <set_timer name="player2ShieldSharingDockCooldownTimer" seconds="1" />

    
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="player3OriginalShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="player3OriginalShieldMaxStateBack" />
    <log text="player3OriginalShieldMaxStateFront=|player3OriginalShieldMaxStateFront| player3OriginalShieldMaxStateBack=|player3OriginalShieldMaxStateBack|" />
    
    <set_variable name="player3ShieldSharingEnabled" value="0.0" />

    <set_timer name="player3ShieldSharingDockCooldownTimer" seconds="1" />

    
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="player4OriginalShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="player4OriginalShieldMaxStateBack" />
    <log text="player4OriginalShieldMaxStateFront=|player4OriginalShieldMaxStateFront| player4OriginalShieldMaxStateBack=|player4OriginalShieldMaxStateBack|" />
    
    <set_variable name="player4ShieldSharingEnabled" value="0.0" />

    <set_timer name="player4ShieldSharingDockCooldownTimer" seconds="1" />

    
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="player5OriginalShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="player5OriginalShieldMaxStateBack" />
    <log text="player5OriginalShieldMaxStateFront=|player5OriginalShieldMaxStateFront| player5OriginalShieldMaxStateBack=|player5OriginalShieldMaxStateBack|" />
    
    <set_variable name="player5ShieldSharingEnabled" value="0.0" />

    <set_timer name="player5ShieldSharingDockCooldownTimer" seconds="1" />

    
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="player6OriginalShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="player6OriginalShieldMaxStateBack" />
    <log text="player6OriginalShieldMaxStateFront=|player6OriginalShieldMaxStateFront| player6OriginalShieldMaxStateBack=|player6OriginalShieldMaxStateBack|" />
    
    <set_variable name="player6ShieldSharingEnabled" value="0.0" />

    <set_timer name="player6ShieldSharingDockCooldownTimer" seconds="1" />

    
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="player7OriginalShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="player7OriginalShieldMaxStateBack" />
    <log text="player7OriginalShieldMaxStateFront=|player7OriginalShieldMaxStateFront| player7OriginalShieldMaxStateBack=|player7OriginalShieldMaxStateBack|" />
    
    <set_variable name="player7ShieldSharingEnabled" value="0.0" />

    <set_timer name="player7ShieldSharingDockCooldownTimer" seconds="1" />

    

    <set_variable name="Shield sharing initted" value="1.0" />
  </event>


  

  <event name="0 comms menu clear" >
    <!-- <log text="0 comms menu clear" /> -->

    <if_variable name="Ship1Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship1CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="-Arm Joint Shield Matrix Prototype MkI" player_slot="0"/>
    <clear_comms_button text="-Disarm Joint Shield Matrix Prototype MkI" player_slot="0"/>
  </event>

  <event name="0 handle Modules button press if no other modules are loaded" >
    <log text="0 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="-Modules" />
    <if_variable name="Ship1ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="-Modules" player_slot="0" />
    <clear_comms_button text="-Cargo &amp; Personnel" player_slot="0" />
    <clear_comms_button text="-Shuttle Operations" player_slot="0" />
    <clear_comms_button text="-Resupply Operations" player_slot="0" />

    <set_comms_button text="-Main Menu" player_slot="0" />

    <set_variable name="Ship1Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="0 comms menu show Enable button" >
    <log text="0 comms menu show Enable button" />

    <if_variable name="Ship1Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="-Arm Joint Shield Matrix Prototype MkI" player_slot="0" />
  </event>

  <event name="0 comms menu show Disable button" >
    <log text="0 comms menu show Disable button" />

    <if_variable name="Ship1Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="-Disarm Joint Shield Matrix Prototype MkI" player_slot="0" />
  </event>

  <event name="0 comms menu on Enable" >
    <log text="0 comms menu on Enable" />

    <if_comms_button text="-Arm Joint Shield Matrix Prototype MkI" player_slot="0"/>
    <set_variable name="player0ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship1Modules" value="0.0" />
    <set_variable name="Ship1CommsMenu" value="0.0" />
    <clear_comms_button text="-Arm Joint Shield Matrix Prototype MkI" player_slot="0"/>

    <incoming_comms_text from="CHANNEL 1" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="0 comms menu on Disable" >
    <log text="0 comms menu on Disable" />

    <if_comms_button text="-Disarm Joint Shield Matrix Prototype MkI" player_slot="0" />
    <set_variable name="player0ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship1Modules" value="0.0" />
    <set_variable name="Ship1CommsMenu" value="0.0" />
    <clear_comms_button text="-Disarm Joint Shield Matrix Prototype MkI" player_slot="0"/>

    <incoming_comms_text from="CHANNEL 1" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="0 decrease front max if over original value" >
    <log text="0 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="0" property="shieldMaxStateFront" comparator="GREATER" value="player0OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="0" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="0 decrease back max if over original value" >
    <log text="0 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="0" property="shieldMaxStateBack" comparator="GREATER" value="player0OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="0" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="0 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="0 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="0" />

    <set_timer name="player0ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  
  
  <event name="0 shares shields with 1" >
    <log text="0 shares shields with 1" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="0" player_slot2="1" comparator="LESS" value="4000" />

    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="0" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="1" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p0IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="0 shares shields with 2" >
    <log text="0 shares shields with 2" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="0" player_slot2="2" comparator="LESS" value="4000" />

    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="0" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="2" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p0IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="0 shares shields with 3" >
    <log text="0 shares shields with 3" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="0" player_slot2="3" comparator="LESS" value="4000" />

    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="0" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="3" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p0IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="0 shares shields with 4" >
    <log text="0 shares shields with 4" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="0" player_slot2="4" comparator="LESS" value="4000" />

    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="0" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="4" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p0IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="0 shares shields with 5" >
    <log text="0 shares shields with 5" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="0" player_slot2="5" comparator="LESS" value="4000" />

    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="0" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="5" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p0IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="0 shares shields with 6" >
    <log text="0 shares shields with 6" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="0" player_slot2="6" comparator="LESS" value="4000" />

    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="0" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="6" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p0IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="0 shares shields with 7" >
    <log text="0 shares shields with 7" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="0" player_slot2="7" comparator="LESS" value="4000" />

    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="0" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="7" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="0" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p0IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  

  <event name="1 comms menu clear" >
    <!-- <log text="1 comms menu clear" /> -->

    <if_variable name="Ship2Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship2CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="*Arm Joint Shield Matrix Prototype MkI" player_slot="1"/>
    <clear_comms_button text="*Disarm Joint Shield Matrix Prototype MkI" player_slot="1"/>
  </event>

  <event name="1 handle Modules button press if no other modules are loaded" >
    <log text="1 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="*Modules" />
    <if_variable name="Ship2ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="*Modules" player_slot="1" />
    <clear_comms_button text="*Cargo &amp; Personnel" player_slot="1" />
    <clear_comms_button text="*Shuttle Operations" player_slot="1" />
    <clear_comms_button text="*Resupply Operations" player_slot="1" />

    <set_comms_button text="*Main Menu" player_slot="1" />

    <set_variable name="Ship2Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="1 comms menu show Enable button" >
    <log text="1 comms menu show Enable button" />

    <if_variable name="Ship2Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="*Arm Joint Shield Matrix Prototype MkI" player_slot="1" />
  </event>

  <event name="1 comms menu show Disable button" >
    <log text="1 comms menu show Disable button" />

    <if_variable name="Ship2Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="*Disarm Joint Shield Matrix Prototype MkI" player_slot="1" />
  </event>

  <event name="1 comms menu on Enable" >
    <log text="1 comms menu on Enable" />

    <if_comms_button text="*Arm Joint Shield Matrix Prototype MkI" player_slot="1"/>
    <set_variable name="player1ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship2Modules" value="0.0" />
    <set_variable name="Ship2CommsMenu" value="0.0" />
    <clear_comms_button text="*Arm Joint Shield Matrix Prototype MkI" player_slot="1"/>

    <incoming_comms_text from="CHANNEL 2" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="1 comms menu on Disable" >
    <log text="1 comms menu on Disable" />

    <if_comms_button text="*Disarm Joint Shield Matrix Prototype MkI" player_slot="1" />
    <set_variable name="player1ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship2Modules" value="0.0" />
    <set_variable name="Ship2CommsMenu" value="0.0" />
    <clear_comms_button text="*Disarm Joint Shield Matrix Prototype MkI" player_slot="1"/>

    <incoming_comms_text from="CHANNEL 2" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="1 decrease front max if over original value" >
    <log text="1 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="1" property="shieldMaxStateFront" comparator="GREATER" value="player1OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="1" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="1 decrease back max if over original value" >
    <log text="1 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="1" property="shieldMaxStateBack" comparator="GREATER" value="player1OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="1" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="1 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="1 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="1" />

    <set_timer name="player1ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  <event name="1 shares shields with 0" >
    <log text="1 shares shields with 0" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="1" player_slot2="0" comparator="LESS" value="4000" />

    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="1" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="0" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p1IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  
  
  <event name="1 shares shields with 2" >
    <log text="1 shares shields with 2" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="1" player_slot2="2" comparator="LESS" value="4000" />

    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="1" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="2" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p1IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="1 shares shields with 3" >
    <log text="1 shares shields with 3" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="1" player_slot2="3" comparator="LESS" value="4000" />

    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="1" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="3" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p1IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="1 shares shields with 4" >
    <log text="1 shares shields with 4" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="1" player_slot2="4" comparator="LESS" value="4000" />

    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="1" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="4" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p1IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="1 shares shields with 5" >
    <log text="1 shares shields with 5" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="1" player_slot2="5" comparator="LESS" value="4000" />

    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="1" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="5" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p1IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="1 shares shields with 6" >
    <log text="1 shares shields with 6" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="1" player_slot2="6" comparator="LESS" value="4000" />

    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="1" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="6" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p1IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="1 shares shields with 7" >
    <log text="1 shares shields with 7" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="1" player_slot2="7" comparator="LESS" value="4000" />

    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="1" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="7" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="1" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p1IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  

  <event name="2 comms menu clear" >
    <!-- <log text="2 comms menu clear" /> -->

    <if_variable name="Ship3Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship3CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="**Arm Joint Shield Matrix Prototype MkI" player_slot="2"/>
    <clear_comms_button text="**Disarm Joint Shield Matrix Prototype MkI" player_slot="2"/>
  </event>

  <event name="2 handle Modules button press if no other modules are loaded" >
    <log text="2 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="**Modules" />
    <if_variable name="Ship3ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="**Modules" player_slot="2" />
    <clear_comms_button text="**Cargo &amp; Personnel" player_slot="2" />
    <clear_comms_button text="**Shuttle Operations" player_slot="2" />
    <clear_comms_button text="**Resupply Operations" player_slot="2" />

    <set_comms_button text="**Main Menu" player_slot="2" />

    <set_variable name="Ship3Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="2 comms menu show Enable button" >
    <log text="2 comms menu show Enable button" />

    <if_variable name="Ship3Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="**Arm Joint Shield Matrix Prototype MkI" player_slot="2" />
  </event>

  <event name="2 comms menu show Disable button" >
    <log text="2 comms menu show Disable button" />

    <if_variable name="Ship3Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="**Disarm Joint Shield Matrix Prototype MkI" player_slot="2" />
  </event>

  <event name="2 comms menu on Enable" >
    <log text="2 comms menu on Enable" />

    <if_comms_button text="**Arm Joint Shield Matrix Prototype MkI" player_slot="2"/>
    <set_variable name="player2ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship3Modules" value="0.0" />
    <set_variable name="Ship3CommsMenu" value="0.0" />
    <clear_comms_button text="**Arm Joint Shield Matrix Prototype MkI" player_slot="2"/>

    <incoming_comms_text from="CHANNEL 3" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="2 comms menu on Disable" >
    <log text="2 comms menu on Disable" />

    <if_comms_button text="**Disarm Joint Shield Matrix Prototype MkI" player_slot="2" />
    <set_variable name="player2ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship3Modules" value="0.0" />
    <set_variable name="Ship3CommsMenu" value="0.0" />
    <clear_comms_button text="**Disarm Joint Shield Matrix Prototype MkI" player_slot="2"/>

    <incoming_comms_text from="CHANNEL 3" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="2 decrease front max if over original value" >
    <log text="2 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="2" property="shieldMaxStateFront" comparator="GREATER" value="player2OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="2" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="2 decrease back max if over original value" >
    <log text="2 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="2" property="shieldMaxStateBack" comparator="GREATER" value="player2OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="2" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="2 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="2 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="2" />

    <set_timer name="player2ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  <event name="2 shares shields with 0" >
    <log text="2 shares shields with 0" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="2" player_slot2="0" comparator="LESS" value="4000" />

    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="2" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="0" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p2IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="2 shares shields with 1" >
    <log text="2 shares shields with 1" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="2" player_slot2="1" comparator="LESS" value="4000" />

    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="2" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="1" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p2IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  
  
  <event name="2 shares shields with 3" >
    <log text="2 shares shields with 3" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="2" player_slot2="3" comparator="LESS" value="4000" />

    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="2" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="3" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p2IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="2 shares shields with 4" >
    <log text="2 shares shields with 4" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="2" player_slot2="4" comparator="LESS" value="4000" />

    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="2" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="4" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p2IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="2 shares shields with 5" >
    <log text="2 shares shields with 5" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="2" player_slot2="5" comparator="LESS" value="4000" />

    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="2" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="5" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p2IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="2 shares shields with 6" >
    <log text="2 shares shields with 6" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="2" player_slot2="6" comparator="LESS" value="4000" />

    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="2" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="6" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p2IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="2 shares shields with 7" >
    <log text="2 shares shields with 7" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="2" player_slot2="7" comparator="LESS" value="4000" />

    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="2" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="7" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="2" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p2IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  

  <event name="3 comms menu clear" >
    <!-- <log text="3 comms menu clear" /> -->

    <if_variable name="Ship4Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship4CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="--Arm Joint Shield Matrix Prototype MkI" player_slot="3"/>
    <clear_comms_button text="--Disarm Joint Shield Matrix Prototype MkI" player_slot="3"/>
  </event>

  <event name="3 handle Modules button press if no other modules are loaded" >
    <log text="3 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="--Modules" />
    <if_variable name="Ship4ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="--Modules" player_slot="3" />
    <clear_comms_button text="--Cargo &amp; Personnel" player_slot="3" />
    <clear_comms_button text="--Shuttle Operations" player_slot="3" />
    <clear_comms_button text="--Resupply Operations" player_slot="3" />

    <set_comms_button text="--Main Menu" player_slot="3" />

    <set_variable name="Ship4Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="3 comms menu show Enable button" >
    <log text="3 comms menu show Enable button" />

    <if_variable name="Ship4Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="--Arm Joint Shield Matrix Prototype MkI" player_slot="3" />
  </event>

  <event name="3 comms menu show Disable button" >
    <log text="3 comms menu show Disable button" />

    <if_variable name="Ship4Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="--Disarm Joint Shield Matrix Prototype MkI" player_slot="3" />
  </event>

  <event name="3 comms menu on Enable" >
    <log text="3 comms menu on Enable" />

    <if_comms_button text="--Arm Joint Shield Matrix Prototype MkI" player_slot="3"/>
    <set_variable name="player3ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship4Modules" value="0.0" />
    <set_variable name="Ship4CommsMenu" value="0.0" />
    <clear_comms_button text="--Arm Joint Shield Matrix Prototype MkI" player_slot="3"/>

    <incoming_comms_text from="CHANNEL 4" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="3 comms menu on Disable" >
    <log text="3 comms menu on Disable" />

    <if_comms_button text="--Disarm Joint Shield Matrix Prototype MkI" player_slot="3" />
    <set_variable name="player3ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship4Modules" value="0.0" />
    <set_variable name="Ship4CommsMenu" value="0.0" />
    <clear_comms_button text="--Disarm Joint Shield Matrix Prototype MkI" player_slot="3"/>

    <incoming_comms_text from="CHANNEL 4" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="3 decrease front max if over original value" >
    <log text="3 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="3" property="shieldMaxStateFront" comparator="GREATER" value="player3OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="3" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="3 decrease back max if over original value" >
    <log text="3 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="3" property="shieldMaxStateBack" comparator="GREATER" value="player3OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="3" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="3 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="3 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="3" />

    <set_timer name="player3ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  <event name="3 shares shields with 0" >
    <log text="3 shares shields with 0" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="3" player_slot2="0" comparator="LESS" value="4000" />

    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="3" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="0" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p3IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="3 shares shields with 1" >
    <log text="3 shares shields with 1" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="3" player_slot2="1" comparator="LESS" value="4000" />

    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="3" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="1" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p3IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="3 shares shields with 2" >
    <log text="3 shares shields with 2" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="3" player_slot2="2" comparator="LESS" value="4000" />

    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="3" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="2" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p3IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  
  
  <event name="3 shares shields with 4" >
    <log text="3 shares shields with 4" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="3" player_slot2="4" comparator="LESS" value="4000" />

    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="3" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="4" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p3IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="3 shares shields with 5" >
    <log text="3 shares shields with 5" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="3" player_slot2="5" comparator="LESS" value="4000" />

    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="3" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="5" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p3IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="3 shares shields with 6" >
    <log text="3 shares shields with 6" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="3" player_slot2="6" comparator="LESS" value="4000" />

    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="3" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="6" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p3IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="3 shares shields with 7" >
    <log text="3 shares shields with 7" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="3" player_slot2="7" comparator="LESS" value="4000" />

    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="3" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="7" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="3" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p3IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  

  <event name="4 comms menu clear" >
    <!-- <log text="4 comms menu clear" /> -->

    <if_variable name="Ship5Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship5CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="*-Arm Joint Shield Matrix Prototype MkI" player_slot="4"/>
    <clear_comms_button text="*-Disarm Joint Shield Matrix Prototype MkI" player_slot="4"/>
  </event>

  <event name="4 handle Modules button press if no other modules are loaded" >
    <log text="4 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="*-Modules" />
    <if_variable name="Ship5ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="*-Modules" player_slot="4" />
    <clear_comms_button text="*-Cargo &amp; Personnel" player_slot="4" />
    <clear_comms_button text="*-Shuttle Operations" player_slot="4" />
    <clear_comms_button text="*-Resupply Operations" player_slot="4" />

    <set_comms_button text="*-Main Menu" player_slot="4" />

    <set_variable name="Ship5Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="4 comms menu show Enable button" >
    <log text="4 comms menu show Enable button" />

    <if_variable name="Ship5Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="*-Arm Joint Shield Matrix Prototype MkI" player_slot="4" />
  </event>

  <event name="4 comms menu show Disable button" >
    <log text="4 comms menu show Disable button" />

    <if_variable name="Ship5Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="*-Disarm Joint Shield Matrix Prototype MkI" player_slot="4" />
  </event>

  <event name="4 comms menu on Enable" >
    <log text="4 comms menu on Enable" />

    <if_comms_button text="*-Arm Joint Shield Matrix Prototype MkI" player_slot="4"/>
    <set_variable name="player4ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship5Modules" value="0.0" />
    <set_variable name="Ship5CommsMenu" value="0.0" />
    <clear_comms_button text="*-Arm Joint Shield Matrix Prototype MkI" player_slot="4"/>

    <incoming_comms_text from="CHANNEL 5" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="4 comms menu on Disable" >
    <log text="4 comms menu on Disable" />

    <if_comms_button text="*-Disarm Joint Shield Matrix Prototype MkI" player_slot="4" />
    <set_variable name="player4ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship5Modules" value="0.0" />
    <set_variable name="Ship5CommsMenu" value="0.0" />
    <clear_comms_button text="*-Disarm Joint Shield Matrix Prototype MkI" player_slot="4"/>

    <incoming_comms_text from="CHANNEL 5" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="4 decrease front max if over original value" >
    <log text="4 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="4" property="shieldMaxStateFront" comparator="GREATER" value="player4OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="4" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="4 decrease back max if over original value" >
    <log text="4 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="4" property="shieldMaxStateBack" comparator="GREATER" value="player4OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="4" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="4 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="4 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="4" />

    <set_timer name="player4ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  <event name="4 shares shields with 0" >
    <log text="4 shares shields with 0" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="4" player_slot2="0" comparator="LESS" value="4000" />

    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="4" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="0" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p4IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="4 shares shields with 1" >
    <log text="4 shares shields with 1" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="4" player_slot2="1" comparator="LESS" value="4000" />

    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="4" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="1" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p4IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="4 shares shields with 2" >
    <log text="4 shares shields with 2" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="4" player_slot2="2" comparator="LESS" value="4000" />

    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="4" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="2" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p4IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="4 shares shields with 3" >
    <log text="4 shares shields with 3" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="4" player_slot2="3" comparator="LESS" value="4000" />

    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="4" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="3" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p4IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  
  
  <event name="4 shares shields with 5" >
    <log text="4 shares shields with 5" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="4" player_slot2="5" comparator="LESS" value="4000" />

    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="4" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="5" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p4IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="4 shares shields with 6" >
    <log text="4 shares shields with 6" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="4" player_slot2="6" comparator="LESS" value="4000" />

    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="4" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="6" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p4IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="4 shares shields with 7" >
    <log text="4 shares shields with 7" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="4" player_slot2="7" comparator="LESS" value="4000" />

    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="4" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="7" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="4" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p4IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  

  <event name="5 comms menu clear" >
    <!-- <log text="5 comms menu clear" /> -->

    <if_variable name="Ship6Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship6CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="-*Arm Joint Shield Matrix Prototype MkI" player_slot="5"/>
    <clear_comms_button text="-*Disarm Joint Shield Matrix Prototype MkI" player_slot="5"/>
  </event>

  <event name="5 handle Modules button press if no other modules are loaded" >
    <log text="5 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="-*Modules" />
    <if_variable name="Ship6ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="-*Modules" player_slot="5" />
    <clear_comms_button text="-*Cargo &amp; Personnel" player_slot="5" />
    <clear_comms_button text="-*Shuttle Operations" player_slot="5" />
    <clear_comms_button text="-*Resupply Operations" player_slot="5" />

    <set_comms_button text="-*Main Menu" player_slot="5" />

    <set_variable name="Ship6Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="5 comms menu show Enable button" >
    <log text="5 comms menu show Enable button" />

    <if_variable name="Ship6Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="-*Arm Joint Shield Matrix Prototype MkI" player_slot="5" />
  </event>

  <event name="5 comms menu show Disable button" >
    <log text="5 comms menu show Disable button" />

    <if_variable name="Ship6Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="-*Disarm Joint Shield Matrix Prototype MkI" player_slot="5" />
  </event>

  <event name="5 comms menu on Enable" >
    <log text="5 comms menu on Enable" />

    <if_comms_button text="-*Arm Joint Shield Matrix Prototype MkI" player_slot="5"/>
    <set_variable name="player5ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship6Modules" value="0.0" />
    <set_variable name="Ship6CommsMenu" value="0.0" />
    <clear_comms_button text="-*Arm Joint Shield Matrix Prototype MkI" player_slot="5"/>

    <incoming_comms_text from="CHANNEL 6" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="5 comms menu on Disable" >
    <log text="5 comms menu on Disable" />

    <if_comms_button text="-*Disarm Joint Shield Matrix Prototype MkI" player_slot="5" />
    <set_variable name="player5ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship6Modules" value="0.0" />
    <set_variable name="Ship6CommsMenu" value="0.0" />
    <clear_comms_button text="-*Disarm Joint Shield Matrix Prototype MkI" player_slot="5"/>

    <incoming_comms_text from="CHANNEL 6" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="5 decrease front max if over original value" >
    <log text="5 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="5" property="shieldMaxStateFront" comparator="GREATER" value="player5OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="5" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="5 decrease back max if over original value" >
    <log text="5 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="5" property="shieldMaxStateBack" comparator="GREATER" value="player5OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="5" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="5 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="5 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="5" />

    <set_timer name="player5ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  <event name="5 shares shields with 0" >
    <log text="5 shares shields with 0" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="5" player_slot2="0" comparator="LESS" value="4000" />

    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="5" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="0" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p5IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="5 shares shields with 1" >
    <log text="5 shares shields with 1" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="5" player_slot2="1" comparator="LESS" value="4000" />

    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="5" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="1" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p5IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="5 shares shields with 2" >
    <log text="5 shares shields with 2" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="5" player_slot2="2" comparator="LESS" value="4000" />

    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="5" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="2" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p5IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="5 shares shields with 3" >
    <log text="5 shares shields with 3" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="5" player_slot2="3" comparator="LESS" value="4000" />

    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="5" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="3" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p5IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="5 shares shields with 4" >
    <log text="5 shares shields with 4" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="5" player_slot2="4" comparator="LESS" value="4000" />

    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="5" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="4" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p5IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  
  
  <event name="5 shares shields with 6" >
    <log text="5 shares shields with 6" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="5" player_slot2="6" comparator="LESS" value="4000" />

    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="5" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="6" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p5IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="5 shares shields with 7" >
    <log text="5 shares shields with 7" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="5" player_slot2="7" comparator="LESS" value="4000" />

    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="5" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="7" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="5" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p5IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  

  <event name="6 comms menu clear" >
    <!-- <log text="6 comms menu clear" /> -->

    <if_variable name="Ship7Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship7CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="_Arm Joint Shield Matrix Prototype MkI" player_slot="6"/>
    <clear_comms_button text="_Disarm Joint Shield Matrix Prototype MkI" player_slot="6"/>
  </event>

  <event name="6 handle Modules button press if no other modules are loaded" >
    <log text="6 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="_Modules" />
    <if_variable name="Ship7ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="_Modules" player_slot="6" />
    <clear_comms_button text="_Cargo &amp; Personnel" player_slot="6" />
    <clear_comms_button text="_Shuttle Operations" player_slot="6" />
    <clear_comms_button text="_Resupply Operations" player_slot="6" />

    <set_comms_button text="_Main Menu" player_slot="6" />

    <set_variable name="Ship7Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="6 comms menu show Enable button" >
    <log text="6 comms menu show Enable button" />

    <if_variable name="Ship7Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="_Arm Joint Shield Matrix Prototype MkI" player_slot="6" />
  </event>

  <event name="6 comms menu show Disable button" >
    <log text="6 comms menu show Disable button" />

    <if_variable name="Ship7Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="_Disarm Joint Shield Matrix Prototype MkI" player_slot="6" />
  </event>

  <event name="6 comms menu on Enable" >
    <log text="6 comms menu on Enable" />

    <if_comms_button text="_Arm Joint Shield Matrix Prototype MkI" player_slot="6"/>
    <set_variable name="player6ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship7Modules" value="0.0" />
    <set_variable name="Ship7CommsMenu" value="0.0" />
    <clear_comms_button text="_Arm Joint Shield Matrix Prototype MkI" player_slot="6"/>

    <incoming_comms_text from="CHANNEL 7" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="6 comms menu on Disable" >
    <log text="6 comms menu on Disable" />

    <if_comms_button text="_Disarm Joint Shield Matrix Prototype MkI" player_slot="6" />
    <set_variable name="player6ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship7Modules" value="0.0" />
    <set_variable name="Ship7CommsMenu" value="0.0" />
    <clear_comms_button text="_Disarm Joint Shield Matrix Prototype MkI" player_slot="6"/>

    <incoming_comms_text from="CHANNEL 7" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="6 decrease front max if over original value" >
    <log text="6 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="6" property="shieldMaxStateFront" comparator="GREATER" value="player6OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="6" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="6 decrease back max if over original value" >
    <log text="6 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="6" property="shieldMaxStateBack" comparator="GREATER" value="player6OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="6" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="6 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="6 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="6" />

    <set_timer name="player6ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  <event name="6 shares shields with 0" >
    <log text="6 shares shields with 0" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="6" player_slot2="0" comparator="LESS" value="4000" />

    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="6" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="0" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p6IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="6 shares shields with 1" >
    <log text="6 shares shields with 1" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="6" player_slot2="1" comparator="LESS" value="4000" />

    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="6" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="1" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p6IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="6 shares shields with 2" >
    <log text="6 shares shields with 2" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="6" player_slot2="2" comparator="LESS" value="4000" />

    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="6" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="2" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p6IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="6 shares shields with 3" >
    <log text="6 shares shields with 3" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="6" player_slot2="3" comparator="LESS" value="4000" />

    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="6" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="3" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p6IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="6 shares shields with 4" >
    <log text="6 shares shields with 4" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="6" player_slot2="4" comparator="LESS" value="4000" />

    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="6" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="4" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p6IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="6 shares shields with 5" >
    <log text="6 shares shields with 5" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="6" player_slot2="5" comparator="LESS" value="4000" />

    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="6" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="5" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p6IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  
  
  <event name="6 shares shields with 7" >
    <log text="6 shares shields with 7" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="6" player_slot2="7" comparator="LESS" value="4000" />

    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="6" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="7" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="6" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p6IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  

  <event name="7 comms menu clear" >
    <!-- <log text="7 comms menu clear" /> -->

    <if_variable name="Ship8Modules" comparator="NOT" value="2.0" />
    <if_variable name="Ship8CommsMenu" comparator="EQUALS" value="1.0" />

    <clear_comms_button text="__Arm Joint Shield Matrix Prototype MkI" player_slot="7"/>
    <clear_comms_button text="__Disarm Joint Shield Matrix Prototype MkI" player_slot="7"/>
  </event>

  <event name="7 handle Modules button press if no other modules are loaded" >
    <log text="7 handle Modules button press if no other modules are loaded" />

    <if_comms_button text="__Modules" />
    <if_variable name="Ship8ModuleType" comparator="EQUALS" value="0.0" />

    <clear_comms_button text="__Modules" player_slot="7" />
    <clear_comms_button text="__Cargo &amp; Personnel" player_slot="7" />
    <clear_comms_button text="__Shuttle Operations" player_slot="7" />
    <clear_comms_button text="__Resupply Operations" player_slot="7" />

    <set_comms_button text="__Main Menu" player_slot="7" />

    <set_variable name="Ship8Modules" value="2.0" integer="yes" />
  </event>

  
  <event name="7 comms menu show Enable button" >
    <log text="7 comms menu show Enable button" />

    <if_variable name="Ship8Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="1.0" />
    <set_comms_button text="__Arm Joint Shield Matrix Prototype MkI" player_slot="7" />
  </event>

  <event name="7 comms menu show Disable button" >
    <log text="7 comms menu show Disable button" />

    <if_variable name="Ship8Modules" comparator="EQUALS" value="2.0" />
    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <set_comms_button text="__Disarm Joint Shield Matrix Prototype MkI" player_slot="7" />
  </event>

  <event name="7 comms menu on Enable" >
    <log text="7 comms menu on Enable" />

    <if_comms_button text="__Arm Joint Shield Matrix Prototype MkI" player_slot="7"/>
    <set_variable name="player7ShieldSharingEnabled" value="1.0" />
    <set_variable name="Ship8Modules" value="0.0" />
    <set_variable name="Ship8CommsMenu" value="0.0" />
    <clear_comms_button text="__Arm Joint Shield Matrix Prototype MkI" player_slot="7"/>

    <incoming_comms_text from="CHANNEL 8" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI ARMED</incoming_comms_text>
  </event>

  <event name="7 comms menu on Disable" >
    <log text="7 comms menu on Disable" />

    <if_comms_button text="__Disarm Joint Shield Matrix Prototype MkI" player_slot="7" />
    <set_variable name="player7ShieldSharingEnabled" value="0.0" />
    <set_variable name="Ship8Modules" value="0.0" />
    <set_variable name="Ship8CommsMenu" value="0.0" />
    <clear_comms_button text="__Disarm Joint Shield Matrix Prototype MkI" player_slot="7"/>

    <incoming_comms_text from="CHANNEL 8" sideValue="playerSide" type="STATUS">Joint Shield Matrix Prototype MkI DISARMED</incoming_comms_text>
  </event>


  <event name="7 decrease front max if over original value" >
    <log text="7 decrease front max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="7" property="shieldMaxStateFront" comparator="GREATER" value="player7OriginalShieldMaxStateFront" />
    <addto_object_property player_slot="7" property="shieldMaxStateFront" value="-0.5" />
  </event>

  <event name="7 decrease back max if over original value" >
    <log text="7 decrease back max if over original value" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />
    <if_object_property player_slot="7" property="shieldMaxStateBack" comparator="GREATER" value="player7OriginalShieldMaxStateBack" />
    <addto_object_property player_slot="7" property="shieldMaxStateBack" value="-0.5" />
  </event>

  <event name="7 prevent shield sharing when docked and right after dock to prevent toggling exploit" >
    <log text="7 prevent shield sharing when docked and right after dock to prevent toggling exploit" />

    <if_docked player_slot="7" />

    <set_timer name="player7ShieldSharingDockCooldownTimer" seconds="15" />
  </event>

  
  
  <event name="7 shares shields with 0" >
    <log text="7 shares shields with 0" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="7" player_slot2="0" comparator="LESS" value="4000" />

    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="0" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player0ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player0ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="7" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="0" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="0" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="0" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="0" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="0" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="0" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="0" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="0" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p7IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="7 shares shields with 1" >
    <log text="7 shares shields with 1" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="7" player_slot2="1" comparator="LESS" value="4000" />

    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="1" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player1ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player1ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="7" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="1" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="1" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="1" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="1" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="1" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="1" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="1" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="1" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p7IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="7 shares shields with 2" >
    <log text="7 shares shields with 2" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="7" player_slot2="2" comparator="LESS" value="4000" />

    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="2" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player2ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player2ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="7" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="2" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="2" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="2" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="2" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="2" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="2" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="2" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="2" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p7IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="7 shares shields with 3" >
    <log text="7 shares shields with 3" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="7" player_slot2="3" comparator="LESS" value="4000" />

    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="3" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player3ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player3ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="7" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="3" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="3" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="3" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="3" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="3" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="3" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="3" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="3" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p7IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="7 shares shields with 4" >
    <log text="7 shares shields with 4" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="7" player_slot2="4" comparator="LESS" value="4000" />

    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="4" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player4ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player4ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="7" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="4" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="4" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="4" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="4" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="4" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="4" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="4" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="4" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p7IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="7 shares shields with 5" >
    <log text="7 shares shields with 5" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="7" player_slot2="5" comparator="LESS" value="4000" />

    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="5" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player5ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player5ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="7" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="5" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="5" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="5" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="5" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="5" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="5" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="5" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="5" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p7IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  <event name="7 shares shields with 6" >
    <log text="7 shares shields with 6" />

    <if_variable name="Shield sharing initted" comparator="NOT" value="0.0" />

    <if_distance player_slot1="7" player_slot2="6" comparator="LESS" value="4000" />

    <if_object_property player_slot="7" property="shieldsOn" comparator="EQUALS" value="1.0" />
    <if_object_property player_slot="6" property="shieldsOn" comparator="EQUALS" value="1.0" />

    <if_variable name="player7ShieldSharingEnabled" comparator="NOT" value="0.0" />
    <if_variable name="player6ShieldSharingEnabled" comparator="NOT" value="0.0" />

    <if_timer_finished name="player7ShieldSharingDockCooldownTimer" />
    <if_timer_finished name="player6ShieldSharingDockCooldownTimer" />


    <set_variable name="pAShieldStateFront" value="0.0" />
    <set_variable name="pAShieldStateBack" value="0.0" />
    <set_variable name="pBShieldStateFront" value="0.0" />
    <set_variable name="pBShieldStateBack" value="0.0" />

    <get_object_property player_slot="7" property="shieldStateFront" variable="pAShieldStateFront" />
    <get_object_property player_slot="7" property="shieldStateBack" variable="pAShieldStateBack" />
    <get_object_property player_slot="6" property="shieldStateFront" variable="pBShieldStateFront" />
    <get_object_property player_slot="6" property="shieldStateBack" variable="pBShieldStateBack" />

    <get_object_property player_slot="7" property="shieldMaxStateFront" variable="pAShieldMaxStateFront" />
    <get_object_property player_slot="7" property="shieldMaxStateBack" variable="pAShieldMaxStateBack" />
    <get_object_property player_slot="6" property="shieldMaxStateFront" variable="pBShieldMaxStateFront" />
    <get_object_property player_slot="6" property="shieldMaxStateBack" variable="pBShieldMaxStateBack" />


    <!-- Average actual current values -->
    <set_variable name="avgStateFront" value="(pAShieldStateFront+pBShieldStateFront) / 2.0" integer="no"/>
    <set_variable name="avgStateBack" value="(pAShieldStateBack+pBShieldStateBack) / 2.0" integer="no"/>

    <!-- Determine new max state front and back, to do this choose the higher value for two player ships.
    We rely on cast to integer to "floor"  -->
    <set_variable name="avgMaxStateFront" value="(pAShieldMaxStateFront+pBShieldMaxStateFront)/2.0" integer="no" />
    <set_variable name="pBIsGreaterFront" value="(pBShieldMaxStateFront-0.1)/avgMaxStateFront" integer="yes" />
    <set_variable name="pAIsGreaterFront" value="pAShieldMaxStateFront/avgMaxStateFront" integer="yes"/>
    <set_variable name="maxStateFront" value="pBIsGreaterFront * pBShieldMaxStateFront + pAIsGreaterFront * pAShieldMaxStateFront" integer="yes"/>

    <set_variable name="avgMaxStateBack" value="(pAShieldMaxStateBack+pBShieldMaxStateBack)/2.0" integer="no" />
    <set_variable name="pBIsGreaterBack" value="(pBShieldMaxStateBack-0.1)/avgMaxStateBack" integer="yes" />
    <set_variable name="pAIsGreaterBack" value="pAShieldMaxStateBack/avgMaxStateBack" integer="yes"/>
    <set_variable name="maxStateBack" value="pBIsGreaterBack * pBShieldMaxStateBack + pAIsGreaterBack * pAShieldMaxStateBack" integer="yes"/>


    <set_object_property player_slot="7" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="7" property="shieldMaxStateBack" value="maxStateBack" />
    <set_object_property player_slot="6" property="shieldMaxStateFront" value="maxStateFront" />
    <set_object_property player_slot="6" property="shieldMaxStateBack" value="maxStateBack" />

    <set_object_property player_slot="7" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="7" property="shieldStateBack" value="avgStateBack" />
    <set_object_property player_slot="6" property="shieldStateFront" value="avgStateFront" />
    <set_object_property player_slot="6" property="shieldStateBack" value="avgStateBack" />


    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatFrontShield" />
    <addto_object_property player_slot="7" value="0.002" property="systemCurHeatBackShield" />

    <set_variable name="p7IsShieldSharing" value="1.0" integer="yes"/>
  </event>
  
  
  
  
  

</mission_data>